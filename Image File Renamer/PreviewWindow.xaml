<Window x:Class="PhotoOrganizer.PreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Preview All" Height="600" Width="800"
        Background="#1E1E1E" Foreground="White"
        WindowStyle="None" ResizeMode="CanResizeWithGrip" AllowsTransparency="False">

    <!-- Outermost border to suppress OS accent line -->
    <Border BorderThickness="0" Background="#1E1E1E" SnapsToDevicePixels="True">
        <Grid>
            <!-- Custom dark gray title bar -->
            <DockPanel Background="#1E1E1E" Height="32" VerticalAlignment="Top"
                       MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <TextBlock Text="Preview All"
                           Foreground="White"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Margin="10,0,0,0"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="—" Width="40" Background="#1E1E1E" Foreground="White"
                            Click="Minimize_Click"/>
                    <Button Content="□" Width="40" Background="#1E1E1E" Foreground="White"
                            Click="Maximize_Click"/>
                    <Button Content="X" Width="40" Background="#1E1E1E" Foreground="White"
                            Click="Close_Click"/>
                </StackPanel>
            </DockPanel>

            <!-- Main content below title bar -->
            <Grid Margin="0,32,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>   <!-- Header -->
                    <RowDefinition Height="*"/>      <!-- ListView -->
                    <RowDefinition Height="Auto"/>   <!-- Summary -->
                    <RowDefinition Height="Auto"/>   <!-- Close button -->
                </Grid.RowDefinitions>

                <TextBlock Text="Preview of file renaming:"
                           Foreground="White" FontWeight="Bold" Margin="5"
                           Grid.Row="0"/>

                <ListView x:Name="PreviewListView" Margin="5" Grid.Row="1"
                          Background="#1E1E1E" Foreground="White"
                          BorderBrush="#444"
                          VirtualizingStackPanel.IsVirtualizing="True"
                          VirtualizingStackPanel.VirtualizationMode="Standard"
                          ScrollViewer.CanContentScroll="True">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Original Filename" DisplayMemberBinding="{Binding Original}" Width="350"/>
                            <GridViewColumn Header="New Filename" DisplayMemberBinding="{Binding New}" Width="350"/>
                        </GridView>
                    </ListView.View>

                    <!-- Color coding -->
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Status}" Value="Skipped">
                                    <Setter Property="Foreground" Value="Gray"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="Overwritten">
                                    <Setter Property="Foreground" Value="Red"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="Appended">
                                    <Setter Property="Foreground" Value="Green"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Status}" Value="Renamed">
                                    <Setter Property="Foreground" Value="White"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                </ListView>

                <TextBlock x:Name="SummaryText" Foreground="White" Margin="5"
                           FontWeight="Bold" Grid.Row="2"/>

                <Button Content="Close" Width="100" Margin="5"
                        HorizontalAlignment="Right" Click="Close_Click"
                        Grid.Row="3"/>
            </Grid>
        </Grid>
    </Border>
</Window>