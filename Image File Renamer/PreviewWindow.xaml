<Window x:Class="PhotoOrganizer.PreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Preview All" Height="600" Width="800"
        Background="#1E1E1E" Foreground="White">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Header -->
            <RowDefinition Height="*"/>      <!-- ListView -->
            <RowDefinition Height="Auto"/>   <!-- Summary -->
            <RowDefinition Height="Auto"/>   <!-- Close button -->
        </Grid.RowDefinitions>

        <TextBlock Text="Preview of file renaming:"
                   Foreground="White" FontWeight="Bold" Margin="5"
                   Grid.Row="0"/>

        <ListView x:Name="PreviewListView" Margin="5" Grid.Row="1"
                  Background="#1E1E1E" Foreground="White"
                  BorderBrush="#444"
                  VirtualizingStackPanel.IsVirtualizing="True"
                  VirtualizingStackPanel.VirtualizationMode="Standard"
                  ScrollViewer.CanContentScroll="True">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Original Filename" DisplayMemberBinding="{Binding Original}" Width="350"/>
                    <GridViewColumn Header="New Filename" DisplayMemberBinding="{Binding New}" Width="350"/>
                </GridView>
            </ListView.View>

            <!-- Color coding -->
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding New}" Value="Skipped">
                            <Setter Property="Foreground" Value="Gray"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding New}" Value="Overwritten">
                            <Setter Property="Foreground" Value="Red"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding New}" Value="{x:Static sys:String.Empty}">
                            <Setter Property="Foreground" Value="White"/>
                        </DataTrigger>
                        <!-- Counter appended heuristic -->
                        <DataTrigger Binding="{Binding New}" Value="{x:Null}">
                            <Setter Property="Foreground" Value="White"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <TextBlock x:Name="SummaryText" Foreground="White" Margin="5"
                   FontWeight="Bold" Grid.Row="2"/>

        <Button Content="Close" Width="100" Margin="5"
                HorizontalAlignment="Right" Click="Close_Click"
                Grid.Row="3"/>
    </Grid>
</Window>